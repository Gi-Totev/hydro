import{r as F,j as o,w as K,L as C,u as L}from"./components-gtVk4ANr.js";import{G as k,K as G}from"./index-DIWb1Ox1.js";import{u as H,P as J}from"./ProductPrice-1MfumZcw.js";import{I as X}from"./Image-CkDhqclR.js";import{A as Q}from"./AddToCartButton-CTUwitKT.js";import"./Money-BidXu4eo.js";const x=",",m={OPTION:":",END_OF_PREFIX:",",SEQUENCE_GAP:" ",RANGE:"-"},A=(()=>{const e=new Map;return function(t,r){var n;if(t.length===0)return!1;if(!e.has(r)){const i=new Set;for(const s of q(r)){i.add(s.join(x));for(let a=0;a<s.length;a++)i.add(s.slice(0,a+1).join(x))}e.set(r,i)}return!!((n=e.get(r))!=null&&n.has(t.join(x)))}})();function q(e){if(!e)return[];if(e.startsWith("v1_"))return M(z(e));throw new Error("Unsupported option value encoding")}const z=e=>e.replace(/^v1_/,"");function M(e){const t=/[ :,-]/g;let r=0,n;const i=[],s=[];let a=0,l=null;for(;n=t.exec(e);){const c=n[0],u=Number.parseInt(e.slice(r,n.index))||0;if(l!==null){for(;l<u;l++)s[a]=l,i.push([...s]);l=null}s[a]=u,c===m.RANGE?l=u:c===m.OPTION?a++:((c===m.SEQUENCE_GAP||c===m.END_OF_PREFIX&&e[n.index-1]!==m.END_OF_PREFIX)&&i.push([...s]),c===m.END_OF_PREFIX&&(s.pop(),a--)),r=t.lastIndex}const p=e.lastIndexOf("-");if(l!=null&&p>0){const c=parseInt(e.substring(p+1));for(;l<=c;l++)s[a]=l,i.push([...s])}return i}function B(e){return e.map(t=>Object.assign({},...t!=null&&t.optionValues?t.optionValues.map((r,n)=>({[r.name]:n})):[]))}function v(e){return Object.assign({},...e.map(t=>({[t.name]:t.value})))}function h(e){return JSON.stringify(v(e))}function R(e,t){return Array.isArray(e)?JSON.stringify(e.map((r,n)=>t[n][r.value])):JSON.stringify(Object.keys(e).map((r,n)=>t[n][e[r]]))}function W(e,t){return Object.assign({},...e.map(r=>({[R(r.selectedOptions||[],t)]:r})))}const I=["options","selectedOrFirstAvailableVariant","adjacentVariants"],Y=["handle","encodedVariantExistence","encodedVariantAvailability"];function d(e){return console.error(`[h2:error:getProductOptions] product.${e} is missing. Make sure you query for this field from the Storefront API.`),!1}function w(e,t=!1){var r;let n=!0;const i=Object.keys(e);if((t?[...I,...Y]:I).forEach(s=>{i.includes(s)||(n=d(s))}),e.options){const s=e==null?void 0:e.options[0];if(t&&!(s!=null&&s.name)&&(n=d("options.name")),(r=e==null?void 0:e.options[0])!=null&&r.optionValues){const a=e.options[0].optionValues[0];t&&!(a!=null&&a.name)&&(n=d("options.optionValues.name")),a!=null&&a.firstSelectableVariant?n=S(a.firstSelectableVariant,"options.optionValues.firstSelectableVariant",n,t):n=d("options.optionValues.firstSelectableVariant")}else n=d("options.optionValues")}return e.selectedOrFirstAvailableVariant&&(n=S(e.selectedOrFirstAvailableVariant,"selectedOrFirstAvailableVariant",n,t)),e.adjacentVariants&&e.adjacentVariants[0]&&(n=S(e.adjacentVariants[0],"adjacentVariants",n,t)),n?e:{}}function S(e,t,r,n){var i;let s=r;if(n&&!((i=e.product)!=null&&i.handle)&&(s=d(`${t}.product.handle`)),e.selectedOptions){const a=e.selectedOptions[0];a!=null&&a.name||(s=d(`${t}.selectedOptions.name`)),a!=null&&a.value||(s=d(`${t}.selectedOptions.value`))}else s=d(`${t}.selectedOptions`);return s}function Z(e){const t=w(e);if(!t.options)return[];const r={};t.options.map(i=>{var s;(s=i.optionValues)==null||s.map(a=>{if(a.firstSelectableVariant){const l=h(a.firstSelectableVariant.selectedOptions);r[l]=a.firstSelectableVariant}})}),t.adjacentVariants.map(i=>{const s=h(i.selectedOptions);r[s]=i});const n=t.selectedOrFirstAvailableVariant;if(n){const i=h(n.selectedOptions);r[i]=n}return Object.values(r)}function ee(e){const t=w(e,!0);if(!t.options)return[];const{options:r,selectedOrFirstAvailableVariant:n,adjacentVariants:i,encodedVariantExistence:s,encodedVariantAvailability:a,handle:l}=t,p=B(r),c=W(n?[n,...i]:i,p),u=v(n?n.selectedOptions:[]);return r.map((f,O)=>({...f,optionValues:f.optionValues.map(b=>{var g;const E={...u};E[f.name]=b.name;const N=R(E,p),V=JSON.parse(N).slice(0,O+1),T=A(V,s||""),U=A(V,a||""),j=c[N]||b.firstSelectableVariant,$=v(j.selectedOptions||[]),D=new URLSearchParams($),y=(g=j==null?void 0:j.product)==null?void 0:g.handle;return{...b,variant:j,handle:y,variantUriQuery:D.toString(),selected:u[f.name]===b.name,exists:T,available:U,isDifferentProduct:y!==l}})}))}function te(e){return F.useEffect(()=>{const t=new URLSearchParams(v(e||[])),r=new URLSearchParams(window.location.search),n=new URLSearchParams({...Object.fromEntries(r),...Object.fromEntries(t)});n.size>0&&window.history.replaceState({},"",`${window.location.pathname}?${n.toString()}`)},[JSON.stringify(e)]),null}function ne({image:e}){return e?o.jsx("div",{className:"product-image",children:o.jsx(X,{alt:e.altText||"Product Image",aspectRatio:"1/1",data:e,sizes:"(min-width: 45em) 50vw, 100vw"},e.id)}):o.jsx("div",{className:"product-image"})}function re({productOptions:e,selectedVariant:t}){const r=K(),{open:n}=H();return o.jsxs("div",{className:"product-form",children:[e.map(i=>i.optionValues.length===1?null:o.jsxs("div",{className:"product-options",children:[o.jsx("h5",{children:i.name}),o.jsx("div",{className:"product-options-grid",children:i.optionValues.map(s=>{const{name:a,handle:l,variantUriQuery:p,selected:c,available:u,exists:P,isDifferentProduct:f,swatch:O}=s;return f?o.jsx(C,{className:"product-options-item",prefetch:"intent",preventScrollReset:!0,replace:!0,to:`/products/${l}?${p}`,style:{border:c?"1px solid black":"1px solid transparent",opacity:u?1:.3},children:o.jsx(_,{swatch:O,name:a})},i.name+a):o.jsx("button",{type:"button",className:`product-options-item${P&&!c?" link":""}`,style:{border:c?"1px solid black":"1px solid transparent",opacity:u?1:.3},disabled:!P,onClick:()=>{c||r(`?${p}`,{replace:!0,preventScrollReset:!0})},children:o.jsx(_,{swatch:O,name:a})},i.name+a)})}),o.jsx("br",{})]},i.name)),o.jsx(Q,{disabled:!t||!t.availableForSale,onClick:()=>{n("cart")},lines:t?[{merchandiseId:t.id,quantity:1,selectedVariant:t}]:[],children:t!=null&&t.availableForSale?"Add to cart":"Sold out"})]})}function _({swatch:e,name:t}){var i,s;const r=(s=(i=e==null?void 0:e.image)==null?void 0:i.previewImage)==null?void 0:s.url,n=e==null?void 0:e.color;return!r&&!n?t:o.jsx("div",{"aria-label":t,className:"product-option-label-swatch",style:{backgroundColor:n||"transparent"},children:!!r&&o.jsx("img",{src:r,alt:t})})}const ue=({data:e})=>[{title:`Hydrogen | ${(e==null?void 0:e.product.title)??""}`},{rel:"canonical",href:`/products/${e==null?void 0:e.product.handle}`}];function de(){const{product:e}=L(),t=k(e.selectedOrFirstAvailableVariant,Z(e));te(t.selectedOptions);const r=ee({...e,selectedOrFirstAvailableVariant:t}),{title:n,descriptionHtml:i}=e;return o.jsxs("div",{className:"product",children:[o.jsx(ne,{image:t==null?void 0:t.image}),o.jsxs("div",{className:"product-main",children:[o.jsx("h1",{children:n}),o.jsx(J,{price:t==null?void 0:t.price,compareAtPrice:t==null?void 0:t.compareAtPrice}),o.jsx("br",{}),o.jsx(re,{productOptions:r,selectedVariant:t}),o.jsx("br",{}),o.jsx("br",{}),o.jsx("p",{children:o.jsx("strong",{children:"Description"})}),o.jsx("br",{}),o.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),o.jsx("br",{})]}),o.jsx(G.ProductView,{data:{products:[{id:e.id,title:e.title,price:(t==null?void 0:t.price.amount)||"0",vendor:e.vendor,variantId:(t==null?void 0:t.id)||"",variantTitle:(t==null?void 0:t.title)||"",quantity:1}]}})]})}export{de as default,ue as meta};
